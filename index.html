<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Distribuidora JazmÃ­n</title>

<style>
*{box-sizing:border-box;}
body{
margin:0;
font-family:'Segoe UI',sans-serif;
background:linear-gradient(135deg,#0f0f0f,#1c1c1c);
color:white;
overflow-x:hidden;
}

header{
display:flex;
align-items:center;
justify-content:center;
gap:10px;
background:#111;
padding:15px;
font-size:22px;
font-weight:bold;
box-shadow:0 4px 20px rgba(0,0,0,0.6);
position:relative;
}

header img{
width:45px;
height:45px;
border-radius:50%;
}

#contador{
position:absolute;
right:20px;
top:15px;
background:#00e676;
color:black;
font-weight:bold;
width:25px;
height:25px;
border-radius:50%;
display:flex;
align-items:center;
justify-content:center;
}

nav{
display:flex;
justify-content:center;
gap:12px;
padding:12px;
}

nav button{
padding:10px 18px;
border:none;
border-radius:25px;
background:#2c2c2c;
color:white;
cursor:pointer;
}

nav button.activo{
background:#00e676;
color:black;
font-weight:bold;
}

input{
display:block;
margin:10px auto;
padding:10px;
width:90%;
max-width:400px;
border-radius:25px;
border:none;
background:#1f1f1f;
color:white;
}

.productos{
display:grid;
grid-template-columns:repeat(auto-fill,minmax(170px,1fr));
gap:15px;
padding:15px;
padding-bottom:250px;
}

.card{
background:#1b1b1b;
padding:15px;
border-radius:20px;
text-align:center;
box-shadow:0 6px 20px rgba(0,0,0,0.5);
}

.precio{
color:#00e676;
font-weight:bold;
}

.estado{
font-size:12px;
margin:6px 0;
}

.sin{color:#ff5252;}
.disp{color:#00e676;}

.controles{
display:flex;
justify-content:center;
align-items:center;
gap:10px;
}

.controles button{
width:32px;
height:32px;
border:none;
border-radius:50%;
background:#00e676;
color:black;
font-size:18px;
cursor:pointer;
}

/* ðŸ”¥ BOTÃ“N FLOTANTE */
#btnFlotante{
position:fixed;
bottom:20px;
right:20px;
width:60px;
height:60px;
border-radius:50%;
border:none;
background:#00e676;
color:black;
font-size:26px;
box-shadow:0 8px 25px rgba(0,0,0,0.7);
cursor:pointer;
z-index:1100;
transition:0.3s;
}

#btnFlotante:hover{
transform:scale(1.1);
}

/* ðŸ”¥ CARRITO */
#carrito{
position:fixed;
bottom:0;
left:0;
right:0;
height:75vh;
background:#111;
border-top-left-radius:30px;
border-top-right-radius:30px;
box-shadow:
0 -30px 80px rgba(0,0,0,0.95),
0 -5px 20px rgba(0,0,0,0.6);
transform:translateY(90%);
transition:transform 0.45s cubic-bezier(.22,1,.36,1),
box-shadow 0.4s ease;
display:flex;
flex-direction:column;
z-index:1000;
}

/* ðŸ”¥ EFECTO COMBINADO PRO */
#carrito.abierto{
transform:translateY(0);
box-shadow:
0 -30px 80px rgba(0,0,0,0.95),
0 -5px 20px rgba(0,0,0,0.6),
0 0 25px rgba(0,230,118,0.6);
}

.marca{
width:60px;
height:6px;
background:#666;
border-radius:10px;
margin:12px auto 5px auto;
cursor:pointer;
}

.carrito-header{
text-align:center;
font-weight:bold;
padding:5px;
}

.toggle-btn{
background:#00e676;
border:none;
padding:5px 15px;
border-radius:20px;
cursor:pointer;
font-size:13px;
}

.carrito-contenido{
flex:1;
overflow-y:auto;
padding:15px;
}

.carrito-footer{
background:#1a1a1a;
padding:10px;
border-top:1px solid #333;
text-align:center;
}

.total{
font-weight:bold;
margin-bottom:5px;
}

.gratis{
color:#00e676;
font-size:13px;
}
</style>
</head>

<body>

<header>
<img src="https://i.postimg.cc/hPRrFtWD/Jazmin-png.jpg">
Distribuidora JazmÃ­n
<div id="contador">0</div>
</header>

<nav>
<button id="btnBebidas" class="activo">Bebidas</button>
<button id="btnAlmacen">AlmacÃ©n</button>
</nav>

<input type="text" id="buscador" placeholder="Buscar producto...">
<div class="productos" id="productos"></div>

<button id="btnFlotante" onclick="toggleCarrito()">ðŸ›’</button>

<div id="carrito">
<div class="marca" onclick="toggleCarrito()"></div>

<div class="carrito-header">
Mi Pedido
<button class="toggle-btn" id="toggleTexto" onclick="toggleCarrito()">Abrir</button>
</div>

<div class="carrito-contenido" id="listaCarrito"></div>

<div class="carrito-footer">
<div class="total" id="total"></div>
<div id="envioGratis" class="gratis"></div>
</div>
</div>

<script>
const SHEET_ID="1ulQgsiH4VPgtws9Abo8wGo4xcwWHVi-hEkeKUqUbRWE";
const BEBIDAS="bebidas";
const ALMACEN="almacen";

let productosBebidas=[];
let productosAlmacen=[];
let productos=[];
let todos=[];
let carrito={};

async function cargarDatos(){
try{
const url1=`https://opensheet.elk.sh/${SHEET_ID}/${BEBIDAS}`;
const url2=`https://opensheet.elk.sh/${SHEET_ID}/${ALMACEN}`;
const [r1,r2]=await Promise.all([fetch(url1),fetch(url2)]);
productosBebidas=await r1.json();
productosAlmacen=await r2.json();
todos=[...productosBebidas,...productosAlmacen];
productos=productosBebidas;
mostrar();
}catch(e){
alert("Error cargando productos. RevisÃ¡ nombre de hojas o permisos.");
}
}

function mostrar(){
const cont=document.getElementById("productos");
cont.innerHTML="";
const filtro=document.getElementById("buscador").value.toLowerCase();
let lista=filtro?todos.filter(p=>p.producto?.toLowerCase().includes(filtro)):productos;

lista.forEach(p=>{
if(!p.codigo||!p.producto||!p.precio) return;
const div=document.createElement("div");
div.className="card";
div.innerHTML=`
<h4>${p.producto}</h4>
<div class="precio">$${Number(p.precio).toLocaleString()}</div>
<div class="estado ${p.estado==="SIN STOCK"?"sin":"disp"}">${p.estado||"DISPONIBLE"}</div>
<div class="controles">
<button onclick="cambiar('${p.codigo}',-1)">-</button>
<span>${carrito[p.codigo]?.cantidad||0}</span>
<button onclick="cambiar('${p.codigo}',1)">+</button>
</div>`;
cont.appendChild(div);
});
}

function cambiar(codigo,val){
const prod=todos.find(p=>p.codigo===codigo);
if(!carrito[codigo]) carrito[codigo]={...prod,cantidad:0};
carrito[codigo].cantidad+=val;
if(carrito[codigo].cantidad<=0) delete carrito[codigo];
actualizar();
mostrar();
}

function actualizar(){
let total=0;
let cant=0;
const lista=document.getElementById("listaCarrito");
lista.innerHTML="";

Object.values(carrito).forEach(p=>{
const precio=Number(p.precio);
const sub=precio*p.cantidad;
total+=sub;
cant+=p.cantidad;
lista.innerHTML+=`<div>${p.producto} x${p.cantidad} - $${sub.toLocaleString()}</div>`;
});

document.getElementById("contador").innerText=cant;

let envio=0;
if(total<40000 && total>0){envio=1500;}
let totalFinal=total+envio;

document.getElementById("total").innerText="Total: $"+totalFinal.toLocaleString();

if(total>=40000){
document.getElementById("envioGratis").innerText="ðŸšš EnvÃ­o GRATIS por superar $40.000";
}else{
document.getElementById("envioGratis").innerText="";
}
}

function toggleCarrito(){
const carritoPanel=document.getElementById("carrito");
const texto=document.getElementById("toggleTexto");
carritoPanel.classList.toggle("abierto");
if(carritoPanel.classList.contains("abierto")){
texto.innerText="Cerrar";
}else{
texto.innerText="Abrir";
}
}

document.getElementById("buscador").addEventListener("input",mostrar);

btnBebidas.onclick=()=>{
productos=productosBebidas;
btnBebidas.classList.add("activo");
btnAlmacen.classList.remove("activo");
mostrar();
};

btnAlmacen.onclick=()=>{
productos=productosAlmacen;
btnAlmacen.classList.add("activo");
btnBebidas.classList.remove("activo");
mostrar();
};

cargarDatos();
</script>
</body>
</html>
